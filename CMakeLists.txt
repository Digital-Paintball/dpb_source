PROJECT(DPB)

SET(DPB_MAJOR_VERSION 0)
SET(DPB_MINOR_VERSION 11)
SET(DPB_VERSION "${DPB_MAJOR_VERSION}.${DPB_MINOR_VERSION}")

EXEC_PROGRAM(svnversion ${DPB_SOURCE_DIR} ARGS ${DPB_SOURCE_DIR} OUTPUT_VARIABLE DPB_REVISION)

MESSAGE("-- Building Digital Paintball ${DPB_VERSION} Build ${DPB_REVISION}")

SET(LIBRARY_OUTPUT_PATH ${DPB_BINARY_DIR}/lib CACHE INTERNAL "Single output directory for building all libraries.")
SET(EXECUTABLE_OUTPUT_PATH ${DPB_BINARY_DIR}/bin CACHE INTERNAL "Single output directory for building all executables.")

IF(WIN32)
	# Single-threaded, static link instead of default multithreaded, dynamic link
	SET(CMAKE_CXX_FLAGS "/W4 /Zm1000 /EHsc /GX /GR" CACHE INTERNAL "Configuration")

	SET(CMAKE_CXX_FLAGS_RELEASE "/ML /O2 /D NDEBUG" CACHE INTERNAL "Configuration")
	SET(CMAKE_CXX_FLAGS_DEBUG "/MLd /ZI /Od /GZ" CACHE INTERNAL "Configuration")
	SET(CMAKE_CXX_FLAGS_MINSIZEREL "/ML /O1 /D NDEBUG" CACHE INTERNAL "Configuration")
	SET(CMAKE_CXX_FLAGS_RELWITHDEBINFO "/ML /Zi /O2 /D NDEBUG" CACHE INTERNAL "Configuration")

	SET(CMAKE_C_FLAGS_DEBUG "/MLd /ZI /Od /GZ" CACHE INTERNAL "Configuration")
	SET(CMAKE_C_FLAGS_MINSIZEREL "/ML /O1 /D NDEBUG" CACHE INTERNAL "Configuration")
	SET(CMAKE_C_FLAGS_RELEASE "/ML /O2 /D NDEBUG" CACHE INTERNAL "Configuration")
	SET(CMAKE_C_FLAGS_RELWITHDEBINFO "/ML /Zi /O2 /D NDEBUG" CACHE INTERNAL "Configuration")
	
	SET(CMAKE_CXX_FLAGS_INIT "/W4 /Zm1000 /GR" CACHE INTERNAL "Configuration")
	SET(CMAKE_CXX_FLAGS_DEBUG_INIT "/MLd /Zi /Od /RTC1" CACHE INTERNAL "Configuration")
	SET(CMAKE_CXX_FLAGS_MINSIZEREL_INIT "/ML /O1 /D NDEBUG" CACHE INTERNAL "Configuration")
	SET(CMAKE_CXX_FLAGS_RELEASE_INIT "/ML /O2 /D NDEBUG" CACHE INTERNAL "Configuration")
	SET(CMAKE_CXX_FLAGS_RELWITHDEBINFO_INIT "/ML /Zi /O2 /D NDEBUG" CACHE INTERNAL "Configuration")

	SET(CMAKE_C_FLAGS_INIT "/W4 /Zm1000" CACHE INTERNAL "Configuration")
	SET(CMAKE_C_FLAGS_DEBUG_INIT "/MLd /ZI /Od /GZ" CACHE INTERNAL "Configuration")
	SET(CMAKE_C_FLAGS_MINSIZEREL_INIT "/ML /O1 /D NDEBUG" CACHE INTERNAL "Configuration")
	SET(CMAKE_C_FLAGS_RELEASE_INIT "/ML /O2 /D NDEBUG" CACHE INTERNAL "Configuration")
	SET(CMAKE_C_FLAGS_RELWITHDEBINFO_INIT "/ML /Zi /O2 /D NDEBUG" CACHE INTERNAL "Configuration")

	SET(CMAKE_SHARED_LINKER_FLAGS "/STACK:10000000 /INCREMENTAL:YES" CACHE INTERNAL "Configuration")
	SET(CMAKE_SHARED_LINKER_FLAGS_DEBUG "/debug /NODEFAULTLIB:LIBC" CACHE INTERNAL "Configuration")
	SET(CMAKE_SHARED_LINKER_FLAGS_MINSIZEREL "" CACHE INTERNAL "Configuration")
	SET(CMAKE_SHARED_LINKER_FLAGS_RELEASE "" CACHE INTERNAL "Configuration")
	SET(CMAKE_SHARED_LINKER_FLAGS_RELWITHDEBINFO "/debug" CACHE INTERNAL "Configuration")
ENDIF(WIN32)

SUBDIRS(src content)
